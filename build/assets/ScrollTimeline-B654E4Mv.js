import{a as he,i as ge,f as O,c as ee,b as te,J as pe,p as xe,v as ve,d as ye,e as we,g as Ee,h as Se,n as ne,k as Ne,s as Le,l as be,r as g,m as Oe,o as _,q as j,M as Te,t as R,w as je,j as c,x as S,V as ze}from"./index-CLcXB_Co.js";const H=new WeakMap;let M;const se=(e,n,i)=>(t,s)=>s&&s[0]?s[0][e+"Size"]:ge(t)&&"getBBox"in t?t.getBBox()[n]:t[i],Re=se("inline","width","offsetWidth"),He=se("block","height","offsetHeight");function Me({target:e,borderBoxSize:n}){H.get(e)?.forEach(i=>{i(e,{get width(){return Re(e,n)},get height(){return He(e,n)}})})}function Ie(e){e.forEach(Me)}function We(){typeof ResizeObserver>"u"||(M=new ResizeObserver(Ie))}function Be(e,n){M||We();const i=he(e);return i.forEach(t=>{let s=H.get(t);s||(s=new Set,H.set(t,s)),s.add(n),M?.observe(t)}),()=>{i.forEach(t=>{const s=H.get(t);s?.delete(n),s?.size||M?.unobserve(t)})}}const I=new Set;let L;function Fe(){L=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};I.forEach(n=>n(e))},window.addEventListener("resize",L)}function Ae(e){return I.add(e),L||Fe(),()=>{I.delete(e),!I.size&&typeof L=="function"&&(window.removeEventListener("resize",L),L=void 0)}}function Ve(e,n){return typeof e=="function"?Ae(e):Be(e,n)}function ie(e,n){let i;const t=()=>{const{currentTime:s}=n,l=(s===null?0:s.value)/100;i!==l&&e(l),i=l};return O.preUpdate(t,!0),()=>ee(t)}function Pe(e,n,i){const t=e.get();let s=null,o=t,l;const u=typeof t=="string"?t.replace(/[\d.-]/g,""):void 0,h=()=>{s&&(s.stop(),s=null)},f=()=>{h(),s=new pe({keyframes:[J(e.get()),J(o)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...i,onUpdate:l})};if(e.attach((x,m)=>{o=x,l=v=>m(G(v,u)),O.postRender(f)},h),te(n)){const x=n.on("change",v=>e.set(G(v,u))),m=e.on("destroy",x);return()=>{x(),m()}}return h}function G(e,n){return n?e+n:e}function J(e){return typeof e=="number"?e:parseFloat(e)}const ke=50,X=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Ce=()=>({time:0,x:X(),y:X()}),$e={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function U(e,n,i,t){const s=i[n],{length:o,position:l}=$e[n],u=s.current,h=i.time;s.current=e[`scroll${l}`],s.scrollLength=e[`scroll${o}`]-e[`client${o}`],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=xe(0,s.scrollLength,s.current);const f=t-h;s.velocity=f>ke?0:ve(s.current-u,f)}function De(e,n,i){U(e,"x",n,i),U(e,"y",n,i),n.time=i}function Ye(e,n){const i={x:0,y:0};let t=e;for(;t&&t!==n;)if(ye(t))i.x+=t.offsetLeft,i.y+=t.offsetTop,t=t.offsetParent;else if(t.tagName==="svg"){const s=t.getBoundingClientRect();t=t.parentElement;const o=t.getBoundingClientRect();i.x+=s.left-o.left,i.y+=s.top-o.top}else if(t instanceof SVGGraphicsElement){const{x:s,y:o}=t.getBBox();i.x+=s,i.y+=o;let l=null,u=t.parentNode;for(;!l;)u.tagName==="svg"&&(l=u),u=t.parentNode;t=l}else break;return i}const $={start:0,center:.5,end:1};function q(e,n,i=0){let t=0;if(e in $&&(e=$[e]),typeof e=="string"){const s=parseFloat(e);e.endsWith("px")?t=s:e.endsWith("%")?e=s/100:e.endsWith("vw")?t=s/100*document.documentElement.clientWidth:e.endsWith("vh")?t=s/100*document.documentElement.clientHeight:e=s}return typeof e=="number"&&(t=n*e),i+t}const _e=[0,0];function Ge(e,n,i,t){let s=Array.isArray(e)?e:_e,o=0,l=0;return typeof e=="number"?s=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?s=e.split(" "):s=[e,$[e]?e:"0"]),o=q(s[0],i,t),l=q(s[1],n),o-l}const Je={All:[[0,0],[1,1]]},Xe={x:0,y:0};function Ue(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function qe(e,n,i){const{offset:t=Je.All}=i,{target:s=e,axis:o="y"}=i,l=o==="y"?"height":"width",u=s!==e?Ye(s,e):Xe,h=s===e?{width:e.scrollWidth,height:e.scrollHeight}:Ue(s),f={width:e.clientWidth,height:e.clientHeight};n[o].offset.length=0;let x=!n[o].interpolate;const m=t.length;for(let v=0;v<m;v++){const N=Ge(t[v],f[l],h[l],u[o]);!x&&N!==n[o].interpolatorOffsets[v]&&(x=!0),n[o].offset[v]=N}x&&(n[o].interpolate=we(n[o].offset,Ee(t),{clamp:!1}),n[o].interpolatorOffsets=[...n[o].offset]),n[o].progress=Se(0,1,n[o].interpolate(n[o].current))}function Ke(e,n=e,i){if(i.x.targetOffset=0,i.y.targetOffset=0,n!==e){let t=n;for(;t&&t!==e;)i.x.targetOffset+=t.offsetLeft,i.y.targetOffset+=t.offsetTop,t=t.offsetParent}i.x.targetLength=n===e?n.scrollWidth:n.clientWidth,i.y.targetLength=n===e?n.scrollHeight:n.clientHeight,i.x.containerLength=e.clientWidth,i.y.containerLength=e.clientHeight}function Qe(e,n,i,t={}){return{measure:s=>{Ke(e,t.target,i),De(e,i,s),(t.offset||t.target)&&qe(e,i,t)},notify:()=>n(i)}}const b=new WeakMap,K=new WeakMap,C=new WeakMap,Q=e=>e===document.scrollingElement?window:e;function re(e,{container:n=document.scrollingElement,...i}={}){if(!n)return ne;let t=C.get(n);t||(t=new Set,C.set(n,t));const s=Ce(),o=Qe(n,e,s,i);if(t.add(o),!b.has(n)){const u=()=>{for(const m of t)m.measure(Ne.timestamp);O.preUpdate(h)},h=()=>{for(const m of t)m.notify()},f=()=>O.read(u);b.set(n,f);const x=Q(n);window.addEventListener("resize",f,{passive:!0}),n!==document.documentElement&&K.set(n,Ve(n,f)),x.addEventListener("scroll",f,{passive:!0}),f()}const l=b.get(n);return O.read(l,!1,!0),()=>{ee(l);const u=C.get(n);if(!u||(u.delete(o),u.size))return;const h=b.get(n);b.delete(n),h&&(Q(n).removeEventListener("scroll",h),K.get(n)?.(),window.removeEventListener("resize",h))}}const Z=new Map;function Ze(e){const n={value:0},i=re(t=>{n.value=t[e.axis].progress*100},e);return{currentTime:n,cancel:i}}function le({source:e,container:n,...i}){const{axis:t}=i;e&&(n=e);const s=Z.get(n)??new Map;Z.set(n,s);const o=i.target??"self",l=s.get(o)??{},u=t+(i.offset??[]).join(",");return l[u]||(l[u]=!i.target&&Le()?new ScrollTimeline({source:n,axis:t}):Ze({container:n,...i})),l[u]}function et(e,n){const i=le(n);return e.attachTimeline({timeline:n.target?void 0:i,observe:t=>(t.pause(),ie(s=>{t.time=t.iterationDuration*s},i))})}function tt(e){return e.length===2}function nt(e,n){return tt(e)?re(i=>{e(i[n.axis].progress,i)},n):ie(e,le(n))}function st(e,{axis:n="y",container:i=document.scrollingElement,...t}={}){if(!i)return ne;const s={axis:n,container:i,...t};return typeof e=="function"?nt(e,s):et(e,s)}const it=()=>({scrollX:j(0),scrollY:j(0),scrollXProgress:j(0),scrollYProgress:j(0)}),z=e=>e?!e.current:!1;function rt({container:e,target:n,...i}={}){const t=be(it),s=g.useRef(null),o=g.useRef(!1),l=g.useCallback(()=>(s.current=st((u,{x:h,y:f})=>{t.scrollX.set(h.current),t.scrollXProgress.set(h.progress),t.scrollY.set(f.current),t.scrollYProgress.set(f.progress)},{...i,container:e?.current||void 0,target:n?.current||void 0}),()=>{s.current?.()}),[e,n,JSON.stringify(i.offset)]);return Oe(()=>{if(o.current=!1,z(e)||z(n)){o.current=!0;return}else return l()},[l]),g.useEffect(()=>{if(o.current)return _(!z(e)),_(!z(n)),l()},[l]),t}function lt(e,n={}){const{isStatic:i}=g.useContext(Te),t=()=>te(e)?e.get():e;if(i)return R(t);const s=je(t());return g.useInsertionEffect(()=>Pe(s,e,n),[s,JSON.stringify(n)]),s}const ct=({events:e,title:n,subtitle:i,finalCard:t,ctaSlot:s})=>{const o=g.useRef(null),l=g.useRef(null),[u,h]=g.useState(-1),[f,x]=g.useState(!1),[m,v]=g.useState(null),N=g.useRef(null),D=g.useRef([]),[W,oe]=g.useState([]),[ce,ae]=g.useState(0),B=0,Y=0,F=1.25,{scrollYProgress:A}=rt({target:o,offset:["start 0.3","end center"]}),V=lt(A,{stiffness:100,damping:30,restDelta:.001});R(V,[0,1],["0%","100%"]);const ue=R(V,r=>{if(m!==null){const a=Math.min(1,r*F),d=Math.max(m+B,0);return`${(a*d).toFixed(3)}px`}return`${(r*100).toFixed(2)}%`}),fe=R(V,r=>{if(m!==null){const a=Math.min(1,r*F),d=Math.max(m+B,0);return`${(a*d+Y).toFixed(2)}px`}return`${(r*100).toFixed(2)}%`});g.useEffect(()=>{const r=A.onChange(a=>{const d=e.length-1,p=Math.min(d,Math.floor(a*(e.length+1e-4)));p>=0&&p<=d&&h(T=>p!==T?p:T);const y=l.current?.getBoundingClientRect().height??0,w=m!==null?Math.max(m+B,0):y,E=Math.min(1,a*F),k=E*w+Y;ae(k),x(m!==null?E>=.999:a>=.995)});return()=>r()},[A,e.length,m]),g.useLayoutEffect(()=>{const r=()=>{if(!l.current||!N.current)return;const a=l.current.getBoundingClientRect(),d=N.current.getBoundingClientRect(),p=d.top+d.height/2-a.top;v(p)};return r(),window.addEventListener("resize",r),window.addEventListener("orientationchange",r),()=>{window.removeEventListener("resize",r),window.removeEventListener("orientationchange",r)}},[]),g.useLayoutEffect(()=>{const r=()=>{if(!l.current)return;const p=l.current.getBoundingClientRect(),y=D.current.map(w=>{if(!w)return 0;const E=w.getBoundingClientRect();return E.top+E.height/2-p.top});oe(y)},a=requestAnimationFrame(r),d=typeof ResizeObserver<"u"?new ResizeObserver(()=>r()):null;return d&&l.current&&d.observe(l.current),window.addEventListener("resize",r),window.addEventListener("orientationchange",r),window.addEventListener("load",r),()=>{cancelAnimationFrame(a),d&&l.current&&d.unobserve(l.current),d?.disconnect(),window.removeEventListener("resize",r),window.removeEventListener("orientationchange",r),window.removeEventListener("load",r)}},[e.length,m]);const de=r=>{const a=r*.15;return{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0,transition:{duration:.7,delay:a,ease:[.42,0,.58,1]}}}},P=r=>{if(r!==void 0)return typeof r=="number"?`${r}px`:r},me=()=>{if(!t)return null;const r=P(t.titleHeight),a=P(t.titleMarginTop),d=P(t.titleMarginBottom),p=r||a||d?{...r?{height:r}:{},...a?{marginTop:a}:{},...d?{marginBottom:d}:{}}:void 0,y=p||t.titleFontSize!==void 0?{...p??{},...t.titleFontSize!==void 0?{fontSize:t.titleFontSize}:{}}:void 0;if(!t.videoText)return c.jsx("h3",{className:"scroll-timeline-card-title",style:y,children:t.title});const{className:w,fontSize:E,...k}=t.videoText,T=["scroll-timeline-final-title",w].filter(Boolean).join(" ");return c.jsx(ze,{...k,className:T,fontSize:t.titleFontSize??E,style:p,children:t.title})};return c.jsxs("div",{ref:o,className:"scroll-timeline",children:[(n||i)&&c.jsxs("div",{className:"scroll-timeline-header",children:[n&&c.jsx("h2",{className:"scroll-timeline-title",children:n}),i&&c.jsx("p",{className:"scroll-timeline-subtitle",children:i})]}),c.jsxs("div",{className:"scroll-timeline-inner",ref:l,children:[c.jsx("div",{className:"scroll-timeline-line"}),c.jsx(S.div,{className:"scroll-timeline-progress",style:{height:ue}}),c.jsxs(S.div,{className:"scroll-timeline-comet-wrapper",style:{top:fe},children:[c.jsx(S.div,{className:"scroll-timeline-comet",animate:f?{scale:[1,1.7,2.3],opacity:[1,.95,0]}:{scale:[1,1.25,1],opacity:1},transition:f?{duration:.9,ease:"easeOut"}:{duration:2,repeat:1/0,ease:"easeInOut"}},f?"comet-burst":"comet-loop"),f&&c.jsx(S.div,{className:"scroll-timeline-comet-explosion",initial:{scale:.8,opacity:.35},animate:{scale:[1,2.8],opacity:[.35,0]},transition:{duration:.95,ease:"easeOut"}})]}),c.jsx("div",{className:"scroll-timeline-events",children:e.map((r,a)=>c.jsxs("div",{className:`scroll-timeline-item ${a%2===0?"scroll-timeline-item--left":"scroll-timeline-item--right"}`,style:a===0?{marginTop:"8rem"}:void 0,children:[c.jsx("div",{className:"scroll-timeline-dot-wrapper",children:(()=>{const d=W.length===e.length&&W[a]!==void 0,p=d?W[a]-12:1/0,y=d&&ce>=p;return c.jsx(S.div,{className:`scroll-timeline-dot ${y?"scroll-timeline-dot--active scroll-timeline-dot--lit":""}`,ref:w=>{D.current[a]=w},animate:y?{scale:[1,1.3,1],boxShadow:["0 0 0px rgba(99,102,241,0)","0 0 14px rgba(99,102,241,0.7)","0 0 0px rgba(99,102,241,0)"]}:{},transition:{duration:.8,repeat:1/0,repeatDelay:4,ease:"easeInOut"}})})()}),c.jsxs(S.article,{className:"scroll-timeline-card timeline-card heavy-blur",variants:de(a),initial:"initial",whileInView:"whileInView",viewport:{once:!1,margin:"-100px"},children:[c.jsx("h3",{className:"scroll-timeline-card-title",children:r.title}),r.year&&c.jsx("div",{className:"scroll-timeline-year",children:r.year}),r.subtitle&&c.jsx("p",{className:"scroll-timeline-card-subtitle",children:r.subtitle}),c.jsx("p",{className:"scroll-timeline-card-text",children:r.description})]})]},r.id||a))}),t&&c.jsxs(S.div,{className:"scroll-timeline-final-card",initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},transition:{duration:.7,ease:[.42,0,.58,1]},viewport:{once:!0,margin:"-100px"},children:[c.jsxs("div",{className:"scroll-timeline-final-connector","aria-hidden":"true",children:[c.jsx("div",{className:"scroll-timeline-final-line"}),c.jsx("div",{className:`scroll-timeline-dot scroll-timeline-dot--active scroll-timeline-dot--final${f?" scroll-timeline-dot--lit":""}`})]}),c.jsxs("article",{className:"scroll-timeline-card scroll-timeline-final-card-content timeline-card heavy-blur",children:[me(),t.subtitle&&c.jsx("div",{className:"scroll-timeline-year",children:t.subtitle}),t.paragraphs.map((r,a)=>c.jsx("p",{className:"scroll-timeline-card-text scroll-timeline-final-text",children:r},a))]})]}),s&&c.jsxs("div",{className:`scroll-timeline-cta-block${f?" scroll-timeline-cta-block--active":""}`,children:[c.jsx("div",{className:"scroll-timeline-cta-line"}),c.jsxs("div",{className:"scroll-timeline-cta-slot",children:[c.jsx("div",{className:"scroll-timeline-cta-dot",ref:N}),s]})]})]})]})};export{ct as ScrollTimeline};
